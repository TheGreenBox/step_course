\newpage
\section{Моделирование}

\subsection{Математическое моделирование}

%\subsubsection{Моделирование в MATLAB}
\subsubsection{Модель ``Hybrid Stepper Motor'' из пакета ``SimPower Systems''}

Для моделирования процессов, протекающих в системе, воспользуемся пакетом MATLAB.
Перед построением модели всей системы, необходимо получить все параметры,
необходимые для использования встроенной модели гибридного шагового двигателя из пакета:

\textit{SimPower Systems -> Second Generation -> Motors and Generators -> Hybrid Stepper Motor.}

Известно всё необходимое, за исключением величины потосцепления, формируемого
постоянными магнитами ротора. Его можно определить по формуле
из \cite{Matlab_help_stepper_motor}:

\begin{equation}
    \label{maximum_flux_linkage}
    \psi_{M} = \frac{30}{\pi p} E_{M} N
\end{equation}

$N$ - частота вращения ротора, об/мин

$$
    p = \frac{360}{2m \cdot step}
$$

$m = 2$ - число фаз шагового двигателя

$step = 1,8$ - шаг углового перемещения шагового двигателя, град

$E_{M}$ - амплитудное значение ЭДС самоиндукции разомнутой обмотки статора, В

Для использования (\ref{maximum_flux_linkage}) проведём следующий эксперимент:
с помощью дополнительного двигателя на стенде разгоним интересующий нас шаговый
двигатель до частоты вращения $N = const$ и с помощью осцилографа определим $E_{M}$
в одной из его разомкнутых обмоток.

\subsubsection{Модель в ``MATLAB Simulink''}
Обозначим процессы которые мы модерируем в работе привода на этой модели:

\begin{itemize}
    \item Моделируем токовые контуры в обмотках двигателя
    \item Считаем что момент пропорционален току, то есть пренебрегаем той частью переходных
            процессов где это не так
    \item Учитываем сухое и вязкое трение
    \item Моделируется 3 среднечастотных резонансных гармоники. %%%  << -- ссылку на статью!
\end{itemize}

\paragraph{ Токовые процессы }
Для контура одной фазы двигателя пренебрегая наличием внутри обмоток емкости, можно записать
закон ома:

Для фазы A:
\begin{equation}
    \frac{di_{a}}{dt} =
        - \frac{R}{L_{0}} i_{a}
        + \frac{K_{T}}{L_{0}} \omega_{r} \sin(N_{r}\theta)
        + \frac{\vartheta_{A+} - \vartheta_{A-}}{L_{0}}
\end{equation}

Для фазы B:
\begin{equation}
    \frac{di_{b}}{dt} =
        - \frac{R}{L_{0}} i_{b}
        - \frac{K_{T}}{L_{0}} \omega_{r} \cos(N_{r}\theta)
        + \frac{\vartheta_{B+} - \vartheta_{B-}}{L_{0}}
\end{equation}
%% здесь надо вставить рисунок кусока модели реализующей эти уравнения
\begin{figure}[ht!]
    \centering
    \includegraphics[width=0.8\textwidth, keepaspectratio]
                    {./src/pictures/drive_model/drive_model_current_equation}
    \caption{Реализация физики электрических процессов в фазе ШД}
    \label{pic_drive_model_current_equation}
\end{figure}

\paragraph{ Уравнения для момента }
Будем считать, что момент пропорционален току в некотором рабочем диапазоне, отсюда можно записать:
$$
    \tau_{a} = - K_{T} i_{a} \sin{N_{r} \theta}
$$
$$
    \tau_{b} = K_{T} i_{b} \cos{N_{r} \theta}
$$
А суммарный момент ни что иное как сумма двух составляющих:
\begin{equation}
    \tau = K_{T} [-i_{a} \sin{N_{r}\theta} + i_{b} \cos{N_{r}\theta}]
\end{equation}

%% здесь надо вставить рисунок кусока модели реализующей эти уравнения

\paragraph{ Диссипативные силы }
В модели учитывает только 2 составляющие трения вязкое и сухое.
Вязкое трение аппроксимировали до составляющей пропорциональной первой производной от угла:
\begin{equation}
    \tau_{\text{тр.вязк.}} = D_{f} \omega_{r}
\end{equation}

Сухое трение получили из формулы:
\begin{equation}
    \tau_{\text{тр.сух.}} = \begin{cases}
         |\tau| \cdot {\omega_{r}}/{|\omega_{r}|}, & \text{если} ~|\tau|  <  D_{d}; \\[2mm]
         D_{d}  \cdot {\omega_{r}}/{|\omega_{r}|}, & \text{если} ~|\tau| \ge D_{d}.
    \end{cases}
\end{equation}

\begin{equation}
    \tau_{\text{тр.}} = \tau_{\text{тр.вязк.}} + \tau_{\text{тр.сух.}}
\end{equation}

\begin{figure}[ht!]
    \centering
    \includegraphics[width=0.7\textwidth, keepaspectratio, clip=true, trim=25mm 35mm 25mm 35mm]
                    {./src/pictures/drive_model/drive_model_friction}
    \caption{Реализация диссипативных сил в модели}
    \label{pic_drive_model_friction}
\end{figure}

%% здесь надо вставить рисунок кусока модели реализующей эти уравнения

\paragraph{ Среднечастотная нестабильность }
Согласно \cite[ур.(5)]{Novel_Modeling_and_Damping} можно выделить три основных
гармоники среднечастотной нестабильности \[1, 2, 4\].
\begin{equation}
    \tau_{\text{рез.}} =   K_{d1} \cdot \sin{   N_{r} \theta + \phi_{1} }
                         + K_{d2} \cdot \sin{ 2 N_{r} \theta + \phi_{2} }
                         + K_{d4} \cdot \sin{ 4 N_{r} \theta + \phi_{4} }
\end{equation}

$K_{d1}$ - амплитуда первой гармоники резонанса момента

$K_{d2}$ - амплитуда второй гармоники резонанса момента

$K_{d4}$ - амплитуда четвертой гармоники резонанса момента

$\phi_{1}$ - фаза первой гармоники резонанса момента

$\phi_{2}$ - фаза второй гармоники резонанса момента

$\phi_{4}$ - фаза четвертой гармоники резонанса момента

Третья, пятая и более высокие гармоники оказывают незначительное влияние, а потому
ими можно и нужно пренебречь.
%% здесь надо вставить рисунок кусока модели реализующей эти уравнения

\newpage
\subsection{Натурное моделирование}

\endinput

